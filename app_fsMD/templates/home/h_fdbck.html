{% load static %}

<section class="feedback-section d-flex align-items-center overflow-hidden">
  <div class="container-fluid py-4 py-lg-5">
    <div class="feedback-shell">

      <div class="text-center mb-4 fade-in fade-in-up scroll-animate delay-1">
        <h1 class="mb-2">What Our Patients Say</h1>
        <p class="mb-0 mx-auto">
          Hear from people who have experienced our services.
        </p>
      </div>

      <div id="feedbackCarousel"
          class="carousel slide fade-in fade-in-up scroll-animate delay-2"
          data-bs-ride="carousel"
          data-bs-touch="true"
          data-bs-interval="6000">

        <div class="carousel-inner">
          {% for feedback in feedbacks %}
            <div class="carousel-item {% if forloop.first %}active{% endif %}">
              <div class="row align-items-center justify-content-center g-4 g-lg-5 feedback-row">

                <div class="col-12 col-lg-6 order-2 order-lg-1">
                  <div class="feedback-quote-inner">
                    <div class="feedback-quote-wrap">
                      <div class="feedback-quote-mark" aria-hidden="true">
                        <i class="fa-solid fa-quote-left"></i>
                      </div>
                      <p class="feedback-quote mb-4">
                        {{ feedback.testimonial }}
                      </p>

                      <div class="fw-bold feedback-name">
                        {{ feedback.first_name }} {{ feedback.last_name }}
                      </div>

                      <div class="feedback-role">
                        Patient
                        {% if feedback.product %}
                          · <span class="feedback-product">{{ feedback.product.name }}</span>
                        {% endif %}
                      </div>

                      <div class="feedback-date text-muted small mt-1">
                        {{ feedback.created_at|date:"F j, Y" }}
                        at
                        {{ feedback.created_at|time:"g:i A" }}
                      </div>

                    </div>
                  </div>
                </div>

                <div class="col-12 col-lg-6 order-1 order-lg-2 d-flex justify-content-center">
                  <div class="feedback-img-wrap">
                    <img class="feedback-img"
                         src="{{ feedback.image.url }}"
                         alt="{{ feedback.first_name }} {{ feedback.last_name }} Portrait">
                    <div class="feedback-badge">
                      <div class="feedback-badge-stars">
                        {% for i in star_range %}
                          {% if i <= feedback.star_rating %}
                            <i class="fa-solid fa-star"></i>
                          {% else %}
                            <i class="fa-regular fa-star"></i>
                          {% endif %}
                        {% endfor %}
                      </div>
                      <div class="feedback-badge-label">Best Treatment</div>
                    </div>
                  </div>
                </div>

              </div>
            </div>
          {% endfor %}
        </div>

        {# ✅ Dynamic indicators centered at the bottom #}
        <div class="carousel-indicators feedback-indicators">
          {% for feedback in feedbacks %}
            <button type="button"
                    data-bs-target="#feedbackCarousel"
                    data-bs-slide-to="{{ forloop.counter0 }}"
                    class="{% if forloop.first %}active{% endif %}"
                    {% if forloop.first %}aria-current="true"{% endif %}
                    aria-label="Slide {{ forloop.counter }}">
            </button>
          {% endfor %}
        </div>

      </div>

    </div>
  </div>
</section>
