{% extends "page_base.html" %}
{% load static %}

{% block title %}Blogs & Updates{% endblock %}
{% block page_title %}Blogs & Updates{% endblock %}
{% block page_breadcrumb %}Blogs & Updates{% endblock %}

{% block page_style %}
background-image:
  linear-gradient(120deg, rgba(0,0,0,.6), rgba(0,0,0,.4)),
  url('{% static "images/bg_page.png" %}');
{% endblock %}

{% block page_content %}

<section id="top" class="blog-page-section py-3 py-lg-5">
  <div class="container">
    <div class="row justify-content-center mb-3 mb-lg-4">
      <div class="col-12 col-lg-10 text-center fade-in-up fade-in delay-1 fade-blocked scroll-animate">
        <span class="d-inline-flex align-items-center gap-2 px-3 py-2 rounded-pill bg-accent-gradient-animated shadow-brand">
          <i class="fa-solid fa-newspaper icon-solid icon-sm"></i>
          <small class="mb-0 text-white">News &amp; Updates • FullScopeMD</small>
        </span>
      </div>
    </div>

    <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center gap-2 gap-md-3 fade-in-up fade-in delay-3 fade-blocked scroll-animate">
      <div class="w-100">
        <h2 class="mb-1">Don’t miss the latest updates and newsletters</h2>
        <p class="mb-0 text-body-sm text-md-body">
          Practical guidance, provider-led education, and telehealth tips—organized by topic so you can find what matters most.
        </p>
      </div>
    </div>
            <div class="divider my-4"></div>
    <div class="mt-4 mb-4 fade-in-up fade-in delay-2 fade-blocked scroll-animate">
      <div id="blogFilters"
           class="blog-filters-scroll d-flex flex-nowrap gap-2 overflow-auto pb-1"
           role="list"
           aria-label="Blog topics">
        <button type="button"
                class="btn btn-outline-primary btn-sm px-3 py-2 text-body-sm {% if active_topic == 'all' %}active{% endif %}"
                data-filter="all"
                aria-pressed="{% if active_topic == 'all' %}true{% else %}false{% endif %}">
          <i class="fa-solid fa-layer-group me-2"></i> All Topics
        </button>
        <button type="button"
                class="btn btn-outline-primary btn-sm px-3 py-2 text-body-sm {% if active_topic == 'weight' %}active{% endif %}"
                data-filter="weight"
                aria-pressed="{% if active_topic == 'weight' %}true{% else %}false{% endif %}">
          <i class="fa-solid fa-scale-balanced me-2"></i> Weight Management
        </button>
        <button type="button"
                class="btn btn-outline-primary btn-sm px-3 py-2 text-body-sm {% if active_topic == 'peptides' %}active{% endif %}"
                data-filter="peptides"
                aria-pressed="{% if active_topic == 'peptides' %}true{% else %}false{% endif %}">
          <i class="fa-solid fa-bolt me-2"></i> Peptide Therapy
        </button>
        <button type="button"
                class="btn btn-outline-primary btn-sm px-3 py-2 text-body-sm {% if active_topic == 'skin' %}active{% endif %}"
                data-filter="skin"
                aria-pressed="{% if active_topic == 'skin' %}true{% else %}false{% endif %}">
          <i class="fa-solid fa-spa me-2"></i> Skin Treatments
        </button>
        <button type="button"
                class="btn btn-outline-primary btn-sm px-3 py-2 text-body-sm {% if active_topic == 'hair' %}active{% endif %}"
                data-filter="hair"
                aria-pressed="{% if active_topic == 'hair' %}true{% else %}false{% endif %}">
          <i class="fa-solid fa-user me-2"></i> Hair Health
        </button>
        <button type="button"
                class="btn btn-outline-primary btn-sm px-3 py-2 text-body-sm {% if active_topic == 'wellness' %}active{% endif %}"
                data-filter="wellness"
                aria-pressed="{% if active_topic == 'wellness' %}true{% else %}false{% endif %}">
          <i class="fa-solid fa-heart-pulse me-2"></i> Wellness Therapy
        </button>
        <button type="button"
                class="btn btn-outline-primary btn-sm px-3 py-2 text-body-sm {% if active_topic == 'primary' %}active{% endif %}"
                data-filter="primary"
                aria-pressed="{% if active_topic == 'primary' %}true{% else %}false{% endif %}">
          <i class="fa-solid fa-stethoscope me-2"></i> Primary Care
        </button>
      </div>
    </div>

    <div class="row g-4 align-items-stretch fade-in-up fade-in delay-3 fade-blocked scroll-animate">
      <div class="col-12 col-lg-5">
        <div class="card border-0 shadow-sm rounded-4 overflow-hidden h-100">
          {% if featured_post %}
            <div class="ratio ratio-16x9">
              <img id="featuredImg"
                   src="{{ featured_post.main_image.url }}"
                   alt="{{ featured_post.title }}"
                   class="w-100 h-100 object-fit-cover"
                   loading="lazy" />
            </div>

            <div class="card-body p-3 p-md-4">
              <div class="d-flex flex-wrap align-items-center gap-2 mb-2">
                <span id="featuredBadge" class="badge rounded-pill bg-muted text-primary-accent">
                  {{ featured_post.badge_label }}
                </span>
                <small id="featuredDate" class="text-caption-sm mb-0">
                  {{ featured_post.published_at|date:"d M Y" }}
                </small>
                <span class="text-caption-sm">•</span>
                <small id="featuredRead" class="text-caption-sm mb-0">
                  {{ featured_post.read_time_label }}
                </small>
              </div>

              <h2 id="featuredTitle" class="mb-2" style="font-size: var(--font-size-h3);">
                {{ featured_post.title }}
              </h2>

              <p id="featuredDesc" class="mb-3">
                {{ featured_post.excerpt }}
              </p>

              <ul id="featuredBullets" class="list-unstyled mb-0 d-grid gap-2">
                {% if featured_post.bullet_1 %}
                  <li class="d-flex gap-2 align-items-start">
                    <i class="fa-solid fa-circle-check text-primary-accent mt-1"></i>
                    <span class="text-body-sm">{{ featured_post.bullet_1 }}</span>
                  </li>
                {% endif %}
                {% if featured_post.bullet_2 %}
                  <li class="d-flex gap-2 align-items-start">
                    <i class="fa-solid fa-circle-check text-primary-accent mt-1"></i>
                    <span class="text-body-sm">{{ featured_post.bullet_2 }}</span>
                  </li>
                {% endif %}
                {% if featured_post.bullet_3 %}
                  <li class="d-flex gap-2 align-items-start">
                    <i class="fa-solid fa-circle-check text-primary-accent mt-1"></i>
                    <span class="text-body-sm">{{ featured_post.bullet_3 }}</span>
                  </li>
                {% endif %}
              </ul>

              <div class="divider my-4"></div>

              <a class="text-body-sm hover-underline-accent d-inline-flex align-items-center gap-2" href="#newsletter">
                Subscribe for monthly updates <i class="fa-solid fa-arrow-right"></i>
              </a>
            </div>
          {% else %}
            <div class="card-body p-3 p-md-4">
              <p class="mb-0 text-body-sm">Blog posts are coming soon.</p>
            </div>
          {% endif %}
        </div>
      </div>

      <div class="col-12 col-lg-7">
        <div class="card border-0 shadow-sm rounded-4 h-100">
          <div class="card-body p-3 p-md-4">
            <div class="d-flex flex-column gap-1 mb-3">
              <h2 class="mb-0" style="font-size: var(--font-size-h3);">This Season’s Topics</h2>
              <p class="mb-0 text-body-sm text-muted">Click a post to preview it on the left.</p>
            </div>

            <div class="divider my-3"></div>

            <div class="blog-list-scroll d-grid gap-3 overflow-auto" id="postsList" role="list">
              {% for post in posts %}
                <button type="button"
                        class="w-100 text-start p-0 border-0 bg-transparent blog-post-btn
                               {% if featured_post and post.id == featured_post.id %}
                                 is-active
                               {% elif not featured_post and forloop.first %}
                                 is-active
                               {% endif %}"
                        data-topic="{{ post.topic }}"
                        data-img="{{ post.main_image.url }}"
                        data-badge="{{ post.badge_label }}"
                        data-date="{{ post.published_at|date:'d M Y' }}"
                        data-read="{{ post.read_time_label }}"
                        data-title="{{ post.title }}"
                        data-desc="{{ post.excerpt }}"
                        data-b1="{{ post.bullet_1 }}"
                        data-b2="{{ post.bullet_2 }}"
                        data-b3="{{ post.bullet_3 }}"
                        role="listitem">
                  <div class="blog-post-card d-flex gap-3 align-items-start p-3 p-md-4 rounded-4 border bg-white
                              {% if featured_post and post.id == featured_post.id %}
                                border-2 border-primary
                              {% endif %}">
                    <img src="{{ post.main_image.url }}"
                         alt="{{ post.title }}"
                         class="rounded-3 object-fit-cover flex-shrink-0"
                         style="width:110px;height:78px;"
                         loading="lazy">
                    <div class="flex-grow-1">
                      <div class="d-flex flex-wrap align-items-center gap-2 mb-2">
                        <span class="badge rounded-pill bg-muted text-primary-accent">
                          {{ post.badge_label }}
                        </span>
                        <small class="text-caption-sm mb-0">
                          {{ post.published_at|date:"d M Y" }}
                        </small>
                        <span class="text-caption-sm">•</span>
                        <small class="text-caption-sm mb-0">
                          {{ post.read_time_label }}
                        </small>
                      </div>
                      <div class="fw-semibold mb-1">{{ post.title }}</div>
                      <p class="mb-0 text-body-sm text-muted">{{ post.excerpt }}</p>
                    </div>
                  </div>
                </button>
              {% empty %}
                <p class="text-body-sm mb-0">No blog posts yet.</p>
              {% endfor %}
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
</section>

<section id="newsletter" class="newsletter-section py-3 py-lg-5">
  <div class="container">
    <div class="bg-muted shadow-sm rounded-4 p-3 p-md-4 p-lg-5 fade-in-up fade-in delay-4 fade-blocked scroll-animate">
      <div class="row g-4 align-items-center">
        <div class="col-12 col-lg-7">
          <div class="d-flex align-items-start gap-3">
            <span class="icon-button shadow-sm-brand flex-shrink-0">
              <i class="fa-solid fa-envelope-open-text icon-gradient icon-md"></i>
            </span>

            <div class="w-100">
              <h2 class="mb-1">Get updates in your inbox</h2>
              <p class="mb-3 text-body-sm text-muted">
                A monthly newsletter with new posts, provider-led education, and practical “what to expect” guidance across weight management, peptides, skin, hair, wellness, and primary care.
                You’ll also receive safety reminders, new-feature updates, and clear next steps when we publish something important.
              </p>

              <ul class="list-unstyled mb-0 d-grid gap-2">
                <li class="text-body-sm d-flex gap-2 align-items-start">
                  <i class="fa-solid fa-circle-check text-primary-accent mt-1"></i>
                  New-topic summaries, patient-friendly checklists, and seasonal wellness tips
                </li>
                <li class="text-body-sm d-flex gap-2 align-items-start">
                  <i class="fa-solid fa-circle-check text-primary-accent mt-1"></i>
                  Program updates, service improvements, and clinic announcements
                </li>
                <li class="text-body-sm d-flex gap-2 align-items-start">
                  <i class="fa-solid fa-circle-check text-primary-accent mt-1"></i>
                  Optional promotions and offers (only if you opt in)
                </li>
              </ul>
            </div>
          </div>
        </div>

        <div class="col-12 col-lg-5">
          <form action="{% url 'newsletter_subscribe' %}" method="POST" class="d-grid gap-2">
            {% csrf_token %}

            <label for="newsletterEmail" class="form-label text-body-sm mb-0">Email address</label>
            <input id="newsletterEmail"
                   name="email"
                   type="email"
                   class="form-control py-2"
                   placeholder="youremail@gmail.com"
                   autocomplete="email"
                   required>

            <div class="d-grid d-sm-flex gap-2 mt-1">
              <button type="submit" class="btn btn-primary px-4 flex-grow-1">
                Subscribe
                <i class="fa-solid fa-paper-plane ms-2 icon-solid"></i>
              </button>

              <a class="btn btn-outline-primary px-4 flex-grow-1" href="{% url 'privacy_policy' %}">
                Privacy Policy
                <i class="fa-solid fa-arrow-right ms-2"></i>
              </a>
            </div>

            <small class="text-caption-sm d-block mt-2 mb-0 text-muted">
              By subscribing, you agree to receive email updates from FullScopeMD. You can unsubscribe anytime.
              Essential healthcare communications (if you become a patient) are separate.
            </small>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>

{% endblock page_content %}
